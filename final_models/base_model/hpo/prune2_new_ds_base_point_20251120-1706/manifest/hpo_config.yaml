study:
    name: "prune2_new_ds_base_point"
    storage: "sqlite:///optuna_studies/hpo.db"
    direction: "minimize"
    resume: true

budget:
    n_trials: 50                # small run now; increase to 20â€“50 for full HPO

resources:
    partition: "STUD"          # STUD has GPUs
    time: "00:30:00"           # increase for larger HPO runs
    mem_gb: 32                 # STUD default per GPU
    cpus_per_task: 2           # STUD default per GPU
    gpus: 1                    # STUD supports 2070 GPUs
    max_parallel: 4            # how many trials to run at once

io:
    outputs_root: "outputs/optuna"
    logs_root: "logs"
    job_name_template: "{study}_{ts}"
    trial_dir_template: "trial_{trial:05d}"

base_config:
    train_config_path: "configs/train_base.yaml"
    train_script_path: "scripts/train_regression.py"

repro:
    snapshot_hpo_config: true
    snapshot_base_config: true
    save_pip_freeze: false
    save_git_commit: false

pruner:
    name: "median" #"none" #"median"
    params:
        n_startup_trials: 15

search_space:
    - { name: "training.epochs",       dist: "choice", choices: [100] }
    - { name: "training.lr",           dist: "loguniform", low: 1.0e-4, high: 3.0e-3 }
    - { name: "training.weight_decay", dist: "loguniform", low: 1.0e-6, high: 1.0e-2 }
    - { name: "training.grad_clip",    dist: "uniform", low: 0.0, high: 1.0, step: 0.1 }
    - { name: "model.hidden_dims",     dist: "choice",
        choices: [[256,256,128], [512,256,128], [512,512,256], [768,384,192]] }
    - { name: "model.dropout",         dist: "uniform", low: 0.00, high: 0.30, step: 0.05 }
    - { name: "model.activation",      dist: "choice", choices: ["relu","gelu","tanh"] }
    - { name: "model.batchnorm",       dist: "choice", choices: [true, false] }
    - { name: "data.batch_size",       dist: "choice", choices: [512, 1024] }
    - { name: "training.point_loss",   dist: "choice", choices: ["huber","mae","mse"] }

post_run:
    export_best: true
    best_dirname: "best"
    best_filename: "best_hparams.json"
    latest_pointer_dir: "outputs/best_hparams/{study}"
